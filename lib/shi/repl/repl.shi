(module shi:repl)

(defn repl (env)
  (write (str "shi(" (environment-get env '*module*) ")> "))

  (trap-error
    (fn ()
      (println (eval env (parse (read-line)))))
    (fn (e)
      (prn e)))

  (repl env))

(defn repl-run ()
  (write (str "Shi Lisp v" *version* " REPL\n"))
  (write "Type (exit) to quit. Or press Ctrl-C\n")
  (set env (environment *env*))
  (environment-set env '*module* 'global)
  (repl env))
